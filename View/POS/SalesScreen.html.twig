{#
/**
 * This file is part of EasyPOS plugin for FacturaScripts
 * Copyright (C) 2019 Juan José Prieto Dzul <juanjoseprieto88@gmail.com>
 */
#}
{% extends 'POS/Layout/Base.html.twig' %}

{% block body %}
    <div class="col-sm-12 col-md-8 col-lg-9 mh-100">
        {{ include('POS/Block/CartBlock.html.twig') }}
    </div>
    <div class="col-sm-12 col-md-4 col-lg-3">
        <div class="p-3 bg-white rounded box-shadow h-100">
            {{ include('POS/Block/FormBlock.html.twig') }}
        </div>
    </div>
{% endblock %}

{% block modals %}
    <div class="modal fade" id="resetModal" tabindex="-1" role="dialog" aria-labelledby="resetModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="resetModalLabel">Reiniciar la venta</h5>
                </div>
                <div class="modal-body">
                    <p>Se reiniciara la información</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">{{ i18n.trans('cancel') }}</button>
                    <button type="button" class="btn btn-danger" onclick="location.reload();">{{ i18n.trans('accept') }}</button>
                </div>
            </div>
        </div>
    </div>
    {{ include('POS/Modal/CheckoutModal.html.twig') }}
    {{ include('POS/Modal/CashupModal.html.twig') }}
    {{ include('POS/Modal/AjaxSearchModal.html.twig') }}
    {{ include('POS/Modal/HistoryModal.html.twig') }}
{% endblock %}
{% block js %}
    <script id="cart-item-template" type="text/template">
        {% verbatim %}
        {{foreach(options.lines)}}
        <tr>
            <td>
                <div class="form-row cart-product-row">
                    <div class="col-lg-2 col-4">
                        <input class="form-control form-control-sm" type="text" value="{{@this.referencia}}" readonly>
                    </div>
                    <div class="col-lg-10 col-8">
                        <input class="form-control form-control-sm" type="text" value="{{@this.descripcion}}" data-index="{{@key}}" data-field="descripcion">
                    </div>
                </div>
            </td>
            <td><input class="form-control cart-item" type="number" value="{{@this.cantidad}}" data-index="{{@key}}" data-field="cantidad"></td>
            <td><input class="form-control cart-item" type="number" value="{{@this.pvpunitario}}" data-index="{{@key}}" data-field="pvpunitario"></td>
            <td><input class="form-control cart-item" type="number" value="{{@this.pvptotal}}" tabindex="-1" readonly></td>
            <td><a href="#" class="cart-item-del" data-index="{{@key}}"><i class="fas fa-trash text-danger"></i></a></td>
        </tr>
        {{/foreach}}
        {% endverbatim %}
    </script>
    <script id="ajax-search-template" type="text/template">
        {% verbatim %}
          {{foreach(options.list)}}
          <tr>
            <td><span class="font-weight-bold">ID: {{@this.code}}</span><br>{{@this.description}}</td>
            <td>
                <button class="btn btn-sm btn-success item-add-button" type="button" data-code="{{ @this.code }}"
                        data-description="{{@this.description}}" data-target="{{target}}">
                    <i class="fas fa-plus"></i>
                </button>
            </td>
          </tr>
        {{/foreach}}
        {% endverbatim %}
    </script>
    <script id="history-template" type="text/template">
        {% verbatim %}
          {{foreach(options.list)}}
          <tr>
            <td>{{@this.codigo}}</td>
            <td>{{@this.tipodoc}}</td>
            <td>{{@this.fecha}}</td>
            <td>{{@this.hora}}</td>
            <td>{{@this.total}}</td>
          </tr>
        {{/foreach}}
        {% endverbatim %}
    </script>
    <script type="text/javascript">
        const CashPaymentMethod = "{{ fsc.getCashPaymentMethod() }}";
        const FormName = "salesDocumentForm";
        const UrlAccess = "POS";
    </script>

    {#TODO: Change to dynamic for release #}
    {{ parent() }}
    <script src="{{ asset('Plugins/EasyPOS/Assets/JS/squirrelly.min.js') }}"></script>
    <script src="{{ asset('Plugins/EasyPOS/Assets/JS/onscan.min.js') }}"></script>
    <script src="{{ asset('Plugins/EasyPOS/Assets/JS/pos.cartitem.js') }}"></script>
    <script src="{{ asset('Plugins/EasyPOS/Assets/JS/pos.app.js') }}"></script>
{% endblock %}
